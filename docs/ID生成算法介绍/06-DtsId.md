# DtsId (DateTime Sequence Id)

`DtsId` 是一种基于日期时间和序列号的 ID 生成器。它的设计目标是生成在单机环境下具有时间顺序且包含序列信息的 ID。

## ID 结构

`DtsId` 生成的 ID 是一个长整型 (long)，其结构如下：

`YYYYMMDDHHMMSS` (14 位) + `Sequence` (5 位)

- **时间戳部分 (Timestamp)**: 前 14 位由当前时间的 `年(YYYY)月(MM)日(DD)时(HH)分(MM)秒(SS)` 组成。这部分保证了 ID 在宏观上的时间有序性。
- **序列号部分 (Sequence)**: 后 5 位是一个序列号，用于在同一秒内生成的 ID 进行区分。序列号对 100000 取模，确保其长度为 5 位。

## 实现原理

`DtsId` 的核心逻辑位于 `uno.xifan.id.generator.distributed.dtsid.DtsId` 类中。

1.  **初始化**: `DtsId` 对象在创建时接收两个参数：

    - `timestamp`: 长整型，表示 ID 生成时的时间戳（单位：秒）。
    - `sequence`: 长整型，表示当前的序列号。

2.  **ID 生成 (`toLong()` 方法)**:
    - 将传入的 `timestamp` (秒级时间戳) 转换为 `LocalDateTime` 对象。
    - 使用 `DateTimeFormatter` (格式为 `yyyyMMddHHmmss`) 将 `LocalDateTime` 对象格式化为字符串。
    - 将格式化后的时间字符串转换为长整型。
    - 将此长整型时间戳乘以 `100000` (为 5 位序列号腾出空间)。
    - 将传入的 `sequence` 对 `100000` 取模，得到一个 0 到 99999 之间的序列号。
    - 将处理后的时间戳部分与序列号部分相加，得到最终的 ID。

## 示例

假设当前时间是 `2023-10-27 10:30:45`，序列号是 `123`。

1.  时间戳格式化为字符串: `20231027103045`
2.  转换为长整型: `20231027103045L`
3.  乘以 `100000`: `2023102710304500000L`
4.  序列号取模: `123 % 100000 = 123`
5.  最终 ID: `2023102710304500000L + 123L = 2023102710304500123L`

## 特点

- **时间有序**: ID 在秒级上是时间有序的。
- **固定长度**: 生成的 ID（长整型表示）通常具有相对固定的位数（19 位左右，取决于年份）。
- **可读性**: ID 的前 14 位直接反映了生成时间，具有一定的可读性。
- **单机适用**: `DtsId` 本身不包含分布式协调逻辑，主要适用于单机环境或由外部保证 `timestamp` 和 `sequence` 唯一性的场景。
- **序列号限制**: 每秒最多能生成 10 万个唯一 ID (00000 - 99999)。

## 使用场景

适用于对 ID 有时间顺序要求，并且 ID 生成速率在每秒 10 万以下的单机应用场景。如果需要在分布式环境中使用，需要外部机制来保证 `timestamp` 和 `sequence` 的全局唯一性和正确分配。
